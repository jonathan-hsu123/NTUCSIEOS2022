#!/usr/bin/env python

from gradelib import *

r = Runner()


@test(20, "thread package with public testcase 0")
def test_thread_0():
    r.run_qemu(shell_script([
        'mp1-0',
    ]))
    r.match(
	'mp1-0',
	'thread 1: 100',
	'thread 2: 0',
	'thread 3: 10000',
	'thread 1: 101',
	'thread 2: 1',
	'thread 3: 10001',
	'thread 1: 102',
	'thread 2: 2',
	'thread 3: 10002',
	'thread 1: 103',
	'thread 2: 3',
	'thread 3: 10003',
	'thread 1: 104',
	'thread 2: 4',
	'thread 3: 10004',
	'thread 1: 105',
	'thread 2: 5',
	'thread 1: 106',
	'thread 2: 6',
	'thread 1: 107',
	'thread 2: 7',
	'thread 1: 108',
	'thread 2: 8',
	'thread 1: 109',
	'thread 2: 9',
	'',
	'exited',
    )


@test(20, "thread package with public testcase 1")
def test_thread_1():
    r.run_qemu(shell_script([
        'mp1-1',
    ]))
    r.match(
	'mp1-1',
	'thread 1: 100',
	'thread 2: 0',
	'thread 3: 10000',
	'thread 4: 1000',
	'thread 5: 10',
	'thread 1: 101',
	'thread 2: 1',
	'thread 3: 10001',
	'thread 4: 1001',
	'thread 5: 11',
	'thread 1: 102',
	'thread 2: 2',
	'thread 3: 10002',
	'thread 4: 1002',
	'thread 1: 103',
	'thread 2: 3',
	'thread 5: 12',
	'thread 4: 1003',
	'thread 1: 104',
	'thread 2: 4',
	'thread 5: 13',
	'thread 4: 1004',
	'thread 2: 5',
	'thread 5: 14',
	'thread 4: 1005',
	'thread 2: 6',
	'thread 5: 15',
	'thread 4: 1006',
	'thread 2: 7',
	'thread 5: 16',
	'thread 4: 1007',
	'thread 2: 8',
	'thread 4: 1008',
	'thread 4: 1009',
	'thread 4: 1010',
	'',
	'exited',
    )

@test(10, "thread package with testcase 0")
def test_thread_2():
    r.run_qemu(shell_script([
        'mp1-6',
    ]))
    r.match(
    'mp1-6',
    'thread 0: exit',
    'thread 1: exit',
    'thread 2: exit',
    'thread 3: exit',
    'thread 4: exit',
    'thread 5: exit',
    'thread 6: exit',
    'thread 7: exit',
    'thread 8: exit',
    'thread 9: exit',
    'thread 10: exit',
    'thread 11: exit',
    'thread 12: exit',
    'thread 13: exit',
    'thread 14: exit',
    'thread 15: exit',
    'thread 16: exit',
    'thread 17: exit',
    'thread 18: exit',
    'thread 19: exit',
    'thread 20: exit',
    '',
    'exited',
    )

@test(10, "thread package with testcase 1")
def test_thread_3():
    r.run_qemu(shell_script([
        'mp1-7',
    ]))
    r.match(
    'mp1-7',
    'exec thread 0',
    'exec thread 10000',
    'exec thread 20000',
    'exec thread 30000',
    'exec thread 40000',
    'exec thread 50000',
    'exec thread 60000',
    'exec thread 70000',
    'exec thread 80000',
    'exec thread 90000',
    'exec thread 100000',
    'exec thread 110000',
    'exec thread 120000',
    'exec thread 130000',
    'exec thread 140000',
    'exec thread 150000',
    'exec thread 160000',
    'exec thread 170000',
    'exec thread 180000',
    'exec thread 190000',
    'exec thread 200000',
    '',
    'exited',
    )

@test(10, "thread package with testcase 2")
def test_thread_4():
    r.run_qemu(shell_script([
        'mp1-2',
    ]))
    r.match(
    'mp1-2',
    'thread 1: 0',
    'thread 2: 0',
    'thread 4: 0',
    'thread 5: 0',
    'thread 3: 0',
    'thread 6: 0',
    'thread 7: 0',
    'thread 1: 1',
    'thread 2: 1',
    'thread 4: 1',
    'thread 5: 1',
    'thread 3: 1',
    'thread 1: 2',
    'thread 2: 2',
    'thread 4: 2',
    'thread 6: 1',
    'thread 1: 3',
    'thread 5: 2',
    'thread 6: 2',
    'thread 1: 4',
    'thread 4: 3',
    'thread 6: 3',
    '',
    'exited',
    )

@test(10, "thread package with testcase 3")
def test_thread_5():
    r.run_qemu(shell_script([
        'mp1-3',
    ]))
    r.match(
    'mp1-3',
    'thread 1: 10',
    'thread 2: 5',
    'thread 3: 1',
    'thread 4: 1',
    'thread 5: 100',
    'thread 1: 11',
    'thread 2: 6',
    'thread 3: 2',
    'thread 4: 2',
    'thread 1: 12',
    'thread 2: 7',
    'thread 3: 3',
    'thread 1: 13',
    'thread 2: 8',
    'thread 5: 101',
    'thread 1: 14',
    'thread 2: 9',
    'thread 5: 102',
    'thread 2: 10',
    'thread 5: 103',
    'thread 2: 11',
    'thread 5: 104',
    'thread 5: 105',
    'thread 5: 106',
    'thread 5: 107',
    'thread 5: 108',
    'thread 5: 109',
    '',
    'exited',
    )

@test(10, "thread package with testcase 4")
def test_thread_6():
    r.run_qemu(shell_script([
        'mp1-4',
    ]))
    r.match(
    'mp1-4',
    'thread 1: 0',
    'thread 4: 0',
    'thread 13: 0',
    'thread 12: 0',
    'thread 3: 0',
    'thread 10: 0',
    'thread 9: 0',
    'thread 1: 1',
    'thread 4: 1',
    'thread 13: 1',
    'thread 12: 1',
    'thread 3: 1',
    'thread 10: 1',
    'thread 9: 1',
    'thread 1: 2',
    'thread 4: 2',
    'thread 13: 2',
    'thread 12: 2',
    'thread 3: 2',
    'thread 10: 2',
    'thread 9: 2',
    'thread 1: 3',
    'thread 4: 3',
    'thread 13: 3',
    'thread 12: 3',
    'thread 3: 3',
    'thread 10: 3',
    'thread 9: 3',
    'thread 1: 4',
    'thread 4: 4',
    'thread 13: 4',
    'thread 3: 4',
    'thread 9: 4',
    'thread 12: 4',
    'thread 10: 4',
    '',
    'exited',
    )

@test(10, "thread package with testcase 5")
def test_thread_7():
    r.run_qemu(shell_script([
        'mp1-5',
    ]))
    r.match(
    'mp1-5',
    'thread 1: 0',
    'thread 5: 0',
    'thread 17: 0',
    'thread 53: 0',
    'thread 161: 0',
    'thread 160: 0',
    'thread 52: 0',
    'thread 158: 0',
    'thread 157: 0',
    'thread 4: 0',
    'thread 14: 0',
    'thread 44: 0',
    'thread 134: 0',
    'thread 133: 0',
    'thread 43: 0',
    'thread 131: 0',
    'thread 130: 0',
    'thread 13: 0',
    'thread 41: 0',
    'thread 125: 0',
    'thread 124: 0',
    'thread 40: 0',
    'thread 122: 0',
    'thread 121: 0',
    'thread 1: 1',
    'thread 16: 0',
    'thread 17: 1',
    'thread 53: 1',
    'thread 161: 1',
    'thread 160: 1',
    'thread 52: 1',
    'thread 158: 1',
    'thread 50: 0',
    'thread 152: 0',
    'thread 151: 0',
    'thread 4: 1',
    'thread 14: 1',
    'thread 44: 1',
    'thread 134: 1',
    'thread 43: 1',
    'thread 131: 1',
    'thread 130: 1',
    'thread 13: 1',
    'thread 41: 1',
    'thread 125: 1',
    'thread 124: 1',
    'thread 40: 1',
    'thread 122: 1',
    'thread 121: 1',
    'thread 1: 2',
    'thread 16: 1',
    'thread 157: 1',
    'thread 53: 2',
    'thread 161: 2',
    'thread 52: 2',
    'thread 158: 2',
    'thread 50: 1',
    'thread 4: 2',
    'thread 14: 2',
    'thread 44: 2',
    'thread 134: 2',
    'thread 43: 2',
    'thread 131: 2',
    'thread 13: 2',
    'thread 41: 2',
    'thread 125: 2',
    'thread 124: 2',
    'thread 40: 2',
    'thread 122: 2',
    'thread 1: 3',
    'thread 16: 2',
    'thread 157: 2',
    'thread 53: 3',
    'thread 52: 3',
    'thread 158: 3',
    'thread 151: 1',
    'thread 121: 2',
    'thread 14: 3',
    'thread 44: 3',
    'thread 134: 3',
    'thread 130: 2',
    'thread 13: 3',
    'thread 41: 3',
    'thread 125: 3',
    'thread 124: 3',
    'thread 40: 3',
    'thread 122: 3',
    'thread 1: 4',
    'thread 16: 3',
    'thread 157: 3',
    'thread 161: 3',
    'thread 52: 4',
    'thread 121: 3',
    'thread 14: 4',
    'thread 44: 4',
    'thread 134: 4',
    'thread 131: 3',
    'thread 13: 4',
    'thread 41: 4',
    'thread 40: 4',
    'thread 1: 5',
    'thread 151: 2',
    'thread 157: 4',
    'thread 161: 4',
    'thread 121: 4',
    'thread 14: 5',
    'thread 122: 4',
    'thread 124: 4',
    'thread 1: 6',
    'thread 52: 5',
    'thread 157: 5',
    'thread 40: 5',
    'thread 44: 5',
    'thread 122: 5',
    'thread 1: 7',
    'thread 161: 5',
    'thread 124: 5',
    'thread 1: 8',
    'thread 157: 6',
    'thread 122: 6',
    'thread 1: 9',
    'thread 1: 10',
    '',
    'exited',
    )

run_tests()
